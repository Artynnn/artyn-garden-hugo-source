/* source: https://github.com/capnfabs/paperesque */

(function () {function Ca(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}function ha(e){"complete"===document.readyState?setTimeout(e,1):window.addEventListener("load",e)}function ta(e){ha(function(){window.addEventListener("resize",e),setTimeout(e,1)})}var q=[];var Ia=function(){return q.some(function(e){return e.activeTargets.length>0})};var qa=function(){return q.some(function(e){return e.skippedTargets.length>0})};var X="ResizeObserver loop completed with undelivered notifications.",ua=function(){var e;"function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:X}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=X),window.dispatchEvent(e)};var ya,C;!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(C||(ya=C={},ya));var k=function(e){return Object.freeze(e)};var ga=function(){return function(e,r){this.inlineSize=e,this.blockSize=r,k(this)}}();var _=function(){function t(t,i,e,h){return this.x=t,this.y=i,this.width=e,this.height=h,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,k(this)}return t.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},t.fromRect=function(i){return new t(i.x,i.y,i.width,i.height)},t}();var G=function(e){return e instanceof SVGElement&&"getBBox"in e},J=function(e){if(G(e)){var t=e.getBBox(),n=t.width,i=t.height;return!n&&!i}var $=e,r=$.offsetWidth,s=$.offsetHeight;return!(r||s||e.getClientRects().length)},M=function(e){var t,n;if(e instanceof Element)return!0;var i=null===(n=null===(t=e)||void 0===t?void 0:t.ownerDocument)||void 0===n?void 0:n.defaultView;return!!(i&&e instanceof i.Element)},za=function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0;}return!1};var y="undefined"!=typeof window?window:{};var A=new WeakMap,ba=/auto|scroll/,la=/^tb|vertical/,pa=/msie|trident/i.test(y.navigator&&y.navigator.userAgent),j=function(e){return parseFloat(e||"0")},w=function(e,$,r){return void 0===e&&(e=0),void 0===$&&($=0),void 0===r&&(r=!1),new ga((r?$:e)||0,(r?e:$)||0)},K=k({devicePixelContentBoxSize:w(),borderBoxSize:w(),contentBoxSize:w(),contentRect:new _(0,0,0,0)}),L=function(e,$){if(void 0===$&&($=!1),A.has(e)&&!$)return A.get(e);if(J(e))return A.set(e,K),K;var r=getComputedStyle(e),i=G(e)&&e.ownerSVGElement&&e.getBBox(),t=!pa&&"border-box"===r.boxSizing,P=la.test(r.writingMode||""),o=!i&&ba.test(r.overflowY||""),a=!i&&ba.test(r.overflowX||""),n=i?0:j(r.paddingTop),s=i?0:j(r.paddingRight),c=i?0:j(r.paddingBottom),Y=i?0:j(r.paddingLeft),v=i?0:j(r.borderTopWidth),l=i?0:j(r.borderRightWidth),p=i?0:j(r.borderBottomWidth),d=Y+s,x=n+c,z=(i?0:j(r.borderLeftWidth))+l,u=v+p,B=a?e.offsetHeight-u-e.clientHeight:0,m=o?e.offsetWidth-z-e.clientWidth:0,g=t?d+z:0,h=t?x+u:0,R=i?i.width:j(r.width)-g-m,S=i?i.height:j(r.height)-h-B,b=R+d+m+z,f=S+x+B+u,O=k({devicePixelContentBoxSize:w(Math.round(R*devicePixelRatio),Math.round(S*devicePixelRatio),P),borderBoxSize:w(b,f,P),contentBoxSize:w(R,S,P),contentRect:new _(Y,n,R,S)});return A.set(e,O),O},H=function(e,$,r){var i=L(e,r),t=i.borderBoxSize,P=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch($){case C.DEVICE_PIXEL_CONTENT_BOX:return o;case C.BORDER_BOX:return t;default:return P;}};var Aa=function(){return function(e){var t=L(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=k([t.borderBoxSize]),this.contentBoxSize=k([t.contentBoxSize]),this.devicePixelContentBoxSize=k([t.devicePixelContentBoxSize])}}();var N=function(e){if(J(e))return 1/0;for(var r=0,t=e.parentNode;t;)r+=1,t=t.parentNode;return r};var Da=function(){var e=1/0,r=[];q.forEach(function(t){if(0!==t.activeTargets.length){var a=[];t.activeTargets.forEach(function(r){var t=new Aa(r.target),s=N(r.target);a.push(t),r.lastReportedSize=H(r.target,r.observedBox),s<e&&(e=s)}),r.push(function(){t.callback.call(t.observer,a,t.observer)}),t.activeTargets.splice(0,t.activeTargets.length)}});for(var t=0,a=r;t<a.length;t++){(0,a[t])()}return e};var Q=function(e){q.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(r){r.isActive()&&(N(r.target)>e?t.activeTargets.push(r):t.skippedTargets.push(r))})})};var Ma=function(){var r=0;for(Q(r);Ia();)r=Da(),Q(r);return qa()&&ua(),r>0};var T,I=[],ia=function(){return I.splice(0).forEach(function(a){return a()})},ja=function(a){if(!T){var r=0,$=document.createTextNode("");new MutationObserver(function(){return ia()}).observe($,{characterData:!0}),T=function(){$.textContent=""+(r?r--:r++)}}I.push(a),T()};var ka=function(e){ja(function(){requestAnimationFrame(e)})};var U=0,ma=function(){return!!U},na=250,oa={attributes:!0,characterData:!0,childList:!0,subtree:!0},V=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],W=function(e){return void 0===e&&(e=0),Date.now()+e},ra=!1,sa=function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var r=this;if(void 0===e&&(e=na),!ra){ra=!0;var t=W(e);ka(function(){var $=!1;try{$=Ma()}finally{if(ra=!1,e=t-W(),!ma())return;$?r.run(1e3):e>0?r.run(e):r.start()}})}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,r=function(){return e.observer&&e.observer.observe(document.body,oa)};document.body?r():y.addEventListener("DOMContentLoaded",r)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),V.forEach(function(r){return y.addEventListener(r,e.listener,!0)}))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),V.forEach(function(r){return y.removeEventListener(r,e.listener,!0)}),this.stopped=!0)},e}(),F=new sa,Z=function(e){!U&&e>0&&F.start(),!(U+=e)&&F.stop()};var va=function(e){return!G(e)&&!za(e)&&"inline"===getComputedStyle(e).display},wa=function(){function e(e,i){this.target=e,this.observedBox=i||C.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e=H(this.target,this.observedBox,!0);return va(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},e}();var xa=function(){return function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t}}();var D=new WeakMap,aa=function(e,r){for(var t=0;t<e.length;t+=1)if(e[t].target===r)return t;return-1},E=function(){function e(){}return e.connect=function(e,r){var t=new xa(e,r);D.set(e,t)},e.observe=function(e,r,t){var s=D.get(e),$=0===s.observationTargets.length;aa(s.observationTargets,r)<0&&($&&q.push(s),s.observationTargets.push(new wa(r,t&&t.box)),Z(1),F.schedule())},e.unobserve=function(e,r){var t=D.get(e),s=aa(t.observationTargets,r),$=1===t.observationTargets.length;s>=0&&($&&q.splice(q.indexOf(t),1),t.observationTargets.splice(s,1),Z(-1))},e.disconnect=function(e){var r=this,t=D.get(e);t.observationTargets.slice().forEach(function(t){return r.unobserve(e,t.target)}),t.activeTargets.splice(0,t.activeTargets.length)},e}();var Ba=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");E.connect(this,e)}return e.prototype.observe=function(e,r){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!M(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");E.observe(this,e,r)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!M(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");E.unobserve(this,e)},e.prototype.disconnect=function(){E.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();var ca="article#main",da="section.footnotes[role=doc-endnotes]",Ea=1260;function Fa(e,t){var o=e.offsetParent.getBoundingClientRect().top;return t.getBoundingClientRect().top-o}function Ga(e){var t=0;Array.prototype.forEach.call(e,function(e,o){var r=document.querySelector("a.footnote-ref[href='#"+e.id+"']"),$=Fa(e,r.closest("p,li")||r);$<t&&($=t),t=$+e.offsetHeight+parseInt(window.getComputedStyle(e).marginBottom)+parseInt(window.getComputedStyle(e).marginTop),e.style.top=$+"px",e.style.position="absolute"})}function Ha(e){Array.prototype.forEach.call(e,function(e,t){e.style.top=null,e.style.position=null})}function ea(e){var t=document.querySelector(da),o=t.querySelectorAll("li[role=doc-endnote]");e?(t.classList.add("floating-footnotes"),Ga(o),Ja()):(Ka(),Ha(o),t.classList.remove("floating-footnotes"))}function Ja(){var e=document.querySelector(ca);fa.observe(e)}function Ka(){fa.disconnect()}var La=function(){var e=!1;return function(){var t=window.innerWidth>=Ea;t!==e&&(ea(t),e=t)}}(),fa=new Ba(function(e,t){ea(!0)});function Na(){Ca(function(){var e=document.querySelector(da),t=document.querySelector(ca),o=t&&!t.classList.contains("no-floating-footnotes");e&&o&&ta(La)})}Na();})();
